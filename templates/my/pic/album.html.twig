{% extends "base.html.twig" %}

{% block title %} Album {{album.name }} {% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.js"></script>
{% endblock %}

{% block body %}
    <br>
    <div class="container" style="padding: 3%;margin-top: 3%;margin-bottom: 3%;border-radius: 0.5rem;background: #fff;">
        <h1 class="text-center">P'tit Album : {{ album.name }}</h1>
        <br>
        {% if album.pictures is empty %}
            <i> Aucune photos</i>
            <small class="d-block text-right mt-3">
                <i class="fa fa-download" aria-hidden="true"></i>
                <a href="{{ path('add_picture',{'id' : album.id}) }}">Ajouter une photo</a>
            </small>
        {% endif %}
        
        <div class="portfolio-item row">
        {% for picture in album.pictures %}
            <div class="item selfie col-lg-3 col-md-4 col-6 col-sm">
                <a class="fancylight popup-btn" href="{{ asset('build/images/gallery/' ~ picture.fileName )}}">
                    <img src="{{asset('build/images/gallery/' ~ picture.fileName )}}" alt="{{ picture.description }}" class="img-fluid">
                    {% if is_granted('ROLE_ADMIN') %}
                        <a id="delete_picture{{ picture.id }}" class="btn-sm btn-danger delete-picture" href="{{ path('delete_picture',{id:picture.id}) }}" style="position: absolute;top: 1%;left: 80%;">
                            <span class="fa fa-trash"></span>
                        </a>
                    {% endif %}                
                </a>
                {#<div class="desc">{% if picture.description is not null%}{{ picture.description }}{% else %}Photo nÂ°: {{ loop.index }}{% endif %}</div>#}
            </div>
        {% endfor %}
        <div class="clearfix"></div>
        </div>
    </div>
        
                
    <!-- Modal delete a picture-->
    <div id="deleteModal" class="modal">
         <div class="modal-content">
            <div class="modal-header">
                <h2 class="margin-auto">Suppression d'une photo</h2>
            </div>
            <div class="modal-body">
                <p>Vous allez supprimer cette photo </p>
                <p>Etes-vous sur?</p>
            </div>
            <div class="modal-footer">
                <a href="" id="btnYes" class="btn btn-danger" data="">Oui</a>
                <a href="#" data-dismiss="modal" aria-hidden="true" class="btn btn-primary">Non</a>
            </div>
         </div>
    </div>

    <script>
        $(document).ready(function() {
            var modal = document.getElementById("deleteModal");

            $('.delete-picture').on('click', function(e) {
                e.preventDefault();
                var href = $(this).attr("href");
                var id = $(this).attr("id");
                $('#btnYes').attr("href",href);
                $('#btnYes').attr("data",id);
                $('#deleteModal').modal('show');
            });
            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {
              if (event.target == modal) {
                modal.style.display = "none";
              }
            };
            
            var popup_btn = $('.popup-btn');
            popup_btn.magnificPopup({
                type : 'image',
                gallery : {
                       enabled : true
                    }
                });

            });
    </script>
{% endblock %}

