{% extends "base.html.twig" %}

{% block title %}Home üè°{% endblock %}

{% block body %}
    <!-- Page Content -->
    <div class="row" style="padding-top:3%;margin-right:0;">
        <div class="" style="flex: 0 0 11.5%;max-width: 11.5%;">
        </div>
        <div class="" style="flex: 0 0 75%;max-width: 75%;">
          <!-- Jumbotron Header -->
            <header class="" style="padding: 3%;margin-top: 3%;margin-bottom: 3%;border-radius: 0.5rem;background: #fff;">
                <div class="">
                    <img src="{{asset('build/images/imali.png')}}" style="width: 80px; float: left; margin-left:15%;" title="logo" alt="Marsupilami">
                    <img src="{{asset('build/images/imali2.png')}}" style="width: 80px; float: right; margin-right: 15%;" title="logo" alt="Marsupilami">
                    <h1 class="text-center">Bienvenue {{ app.user.username }} sur le site d'Imaliii ‚ù§Ô∏è</h1>
                </div>
                <br>
                <div class="row">
                    <div class="col-md-6">
                        <p class="lead text-center">P'tits √©v√®nements qui arrivent üçª:</p>
                        <div id="calendar"></div>
                    </div>
                    <div class="col-md-6">
                        <div id="myCarousel" class="carousel slide" data-ride="carousel">
                            <ol class="carousel-indicators">
                              <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                              <li data-target="#myCarousel" data-slide-to="1"></li>
                              <li data-target="#myCarousel" data-slide-to="2"></li>
                              <li data-target="#myCarousel" data-slide-to="3"></li>
                            </ol>
                            <div class="carousel-inner">
                              <div class="carousel-item active">
                                <img class="d-block w-100" src="{{asset('build/images/dashboard/background1.jpg')}}" alt="First slide">
                              </div>
                              <div class="carousel-item">
                                <img class="d-block w-100" src="{{asset('build/images/dashboard/background2.jpg')}}" alt="Second slide">
                              </div>
                              <div class="carousel-item">
                                <img class="d-block w-100" src="{{asset('build/images/dashboard/background3.jpg')}}" alt="Third slide">
                              </div>
                              <div class="carousel-item">
                                <img class="d-block w-100" src="{{asset('build/images/dashboard/background4.jpg')}}" alt="Fourth slide">
                              </div>
                            </div>
                            <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col-md-12">
                        <p class="lead text-center">P'tites statistiques üìä:</p>
                        <div class="row">
                            <div class="col-md-4 text-center">
                                <li class="block">
                                    <a class="btn btn-outline-success block no-decoration bottom" href="#"> 
                                        Nombre d'utilisateurs üê¢: {{ users|length }}
                                    </a>
                                </li>
                                <li class="block">
                                    <a class="btn btn-outline-success block no-decoration"  href="{{ path('resume') }}"> 
                                        Nombre d'√©v√®nements üéñÔ∏è: {{ events|length }}
                                    </a>
                                </li>
                            </div>
                            <div class="col-md-4 text-center">
                                <li class="block">
                                    <a class="btn btn-outline-primary block no-decoration bottom"  href="{{ path('gallery',{type: 'album'}) }}"> 
                                        Nombre d'albums üåÑ: {{ nbAlbums }}
                                    </a>
                                </li>
                                <li class="block">
                                    <a class="btn btn-outline-primary block no-decoration"  href="{{ path('gallery') }}"> 
                                        Nombre de photos üèïÔ∏è: {{ nbPictures }}
                                    </a>
                                </li>
                            </div>
                            <div class="col-md-4 text-center">
                                <li class="block">
                                    <a class="btn btn-outline-danger block no-decoration bottom"  href="{{ path('radio') }}"> 
                                        Nombre de musiques üîä: {{ nbSongs }}
                                    </a>
                                </li>
                                <li class="block">
                                    <a class="btn btn-outline-danger block no-decoration"  href="{{ path('map',{map: 'recommandation'}) }}"> 
                                        Nombre de recommandations üåç: {{ nbRecommandations }}
                                    </a>
                                </li>
                            </div>
                        </div>
                    </div>
                </div>

            </header>

            <!-- Page Features -->
            <!--
            <div class="row text-center">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card h-100">
                        <img class="card-img-top" src="{{ asset("build/images/dashboard/4.jpg") }}" alt="">
                        <div class="card-body">
                            <h4 class="card-title">
                                <i class="fa fa-calendar" aria-hidden="true"></i>
                                Calendrier
                            </h4>
                            <p class="card-text">P'tit calendrier avec toutes les infos utiles depuis 2016</p>
                        </div>
                        <div class="card-footer">
                            <a href="{{ path('calendar') }}" class="btn btn-primary">Laisse moi voir ca !</a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card h-100">
                        <img class="card-img-top" src="{{ asset("build/images/dashboard/3.jpg") }}" alt="">
                        <div class="card-body">
                            <h4 class="card-title">
                                <i class="fa fa-newspaper-o" aria-hidden="true"></i>
                                Localisation
                            </h4>
                            <p class="card-text">P'tites maps des potos, qui est o√π ?</p>
                        </div>
                        <div class="card-footer">
                            <a href="{{ path('map') }}" class="btn btn-primary">Je veux les localiser !</a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card h-100">
                        <img class="card-img-top" src="{{ asset("build/images/dashboard/1.jpg") }}" alt="lunettes du sheit">
                        <div class="card-body">
                            <h4 class="card-title">
                                <i class="fa fa-camera-retro" aria-hidden="true"></i>
                                Photos
                            </h4>
                            <p class="card-text">Consultez les belles P'tites bouilles de l'√©quipe</p>
                        </div>
                        <div class="card-footer">
                            <a href="{{ path('gallery') }}" class="btn btn-primary">Photos Potos</a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="card h-100">
                        <img class="card-img-top" src="{{ asset("build/images/dashboard/2.jpg") }}" alt="cristal">
                        <div class="card-body">
                            <h4 class="card-title">
                              <i class="fa fa-commenting" aria-hidden="true"></i>
                              R√©sum√© de l'√©quipe
                            </h4>
                            <p class="card-text">Tous les P'tits potes et √©v√®nements</p>
                            <!--
                            <ul class="list-group">
                                {% for event in events | slice(0,4) %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <a href="{{ path('event',{'id': event.id}) }}">
                                            <strong class="">{{ event.name }}</strong>
                                            <span class="badge badge-primary badge-pill">{{ event.startDate|time_diff }}</span>
                                        </a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="card-footer">
                            <a href="{{ path('resume') }}" class="btn btn-primary">Trop chauuuud ^^</a>
                        </div>
                    </div>
                </div>

            </div>
          -->
          <div class="my-3 p-3 bg-white rounded box-shadow">
            <h6 class="border-bottom border-gray pb-2 mb-0">Les p'tits mises √† jour üõ∞Ô∏è</h6>
                {% for info in infosPage %}
                    <div class="pt-3 big">
                        <a class="no-decoration media"{% if info.link_attr is defined %}href="{{ path(info.link,{id: info.link_attr}) }}"{% else %}href="{{ path(info.link) }}"{% endif %}>
                            <img class="mr-2 rounded" src="{{asset('build/images/profile/' ~ info.name ~ '.jpg')}}" alt="{{ info.name }}" style="width: 5%;height: 100%;border-radius: 10%;">
                            <p class="media-body pb-3 mb-0 small lh-125 border-bottom border-gray">
                                <strong class="d-block text-gray-dark">{{ info.name }} </strong>
                                {{ info.description }}
                                <i>{{ info.date|time_diff }}</i>
                            </p>
                            <span>
                                {% if info.type == "Profil" %} üëª
                                {% elseif info.type == "Event" %}üôå
                                {% elseif info.type == "Album" %}‚úàÔ∏è
                                {% elseif info.type == "Picture" %}üì∏Ô∏è
                                {% elseif info.type == "Song" %}üé∏
                                {% elseif info.type == "Recommandation" %}‚≠ê
                                {% endif %}
                            </span>

                        </a>
                    </div>
                {% endfor %}
            <br>
            <div class="navigation"> 
                {{ knp_pagination_render(infosPage) }}
            </div>
          </div>

        </div>
        <div class="" style="flex: 0 0 13.5%;max-width: 13.5%;padding:1%;">
            <div class="card my-3">
              <h5 class="card-header text-center">Routes</h5>
              <div class="card-body" style='padding:0.5rem;'>               
                  <ul class="list-unstyled mb-0">
                    <li>
                        <div class="d-block">
                            <a href="{{ path('resume') }}">
                                üéâ P'tit r√©cap
                            </a>
                        </div>                      
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('gallery') }}">
                                üèùÔ∏è P'tite gallerie
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('map') }}">
                                üó∫Ô∏è P'tite map
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('calendar') }}">
                                üìÜ P'tit calendrier
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('profile',{id: user.id}) }}">
                                üë®‚Äçüíª P'tit profil
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('catan') }}">
                                üé≤ P'tit CATAN
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a href="{{ path('radio') }}">
                                üï∫ P'tite radio
                            </a>
                        </div>                       
                    </li>
                     <li>
                        <div class="d-block">
                            <a href="{{ path('convertor') }}">
                                üì• P'tit convertor
                            </a>
                        </div>                       
                    </li>
                  </ul>
                </div>
              </div>
              <div class="card my-3">
              <h5 class="card-header text-center">Ajout</h5>
              <div class="card-body" style='padding:0.5rem;'>               
                  <ul class="list-unstyled mb-0">
                    <li>
                        <div class="d-block">
                            <a class="add-event" href="{{ path('add_event') }}">
                                üì£ Add event
                            </a>
                        </div>                      
                    </li>
                    <li>
                        <div class="d-block">
                            <a class="add-album" href="{{ path('add_album') }}">
                                üêï Add album
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a class="add-picture" href="{{ path('add_picture') }}">
                                üèñÔ∏è Add photo
                            </a>
                        </div>                       
                    </li>
                    <li>
                        <div class="d-block">
                            <a class="add-song" href="{{ path('add_song') }}">
                                üé∂ Add musique
                            </a>
                        </div>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
        </div>
    </div>
      
    <!-- Modal add an event -->
    <div id="addEventModal" class="modal" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                   <h5 class="modal-title">Ajout d'un P'tit Ev√®nement üç∫ ü•®</h5>
                   <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                       <span aria-hidden="true">&times;</span>
                   </button>
               </div>
               <div class="modal-body">
                   {{ form_start(eventForm, {'method': 'post', 'action': path('add_event')}) }}
                   {{ form_widget(eventForm, {'attr': {'class': 'form-group'}}) }}
               </div>
                <div class="modal-footer">
                   <div class="form-group middle">
                       <input class=" btn btn-primary" type="submit" value="Ajouter" />
                   </div>
                   {{ form_rest(eventForm) }}
                   {{ form_end(eventForm) }}
               </div>
            </div>
        </div>
    </div>
            
    <!-- Modal add an album -->
    <div id="addAlbumModal" class="modal" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                   <h5 class="modal-title">Ajout d'un P'tit Album üåÑ</h5>
                   <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                       <span aria-hidden="true">&times;</span>
                   </button>
               </div>
               <div class="modal-body">
                   {{ form_start(albumForm, {'method': 'post', 'action': path('add_album')}) }}
                   {{ form_widget(albumForm, {'attr': {'class': 'form-group'}}) }}
               </div>
                <div class="modal-footer">
                   <div class="form-group middle">
                       <input class=" btn btn-primary" type="submit" value="Ajouter" />
                   </div>
                   {{ form_rest(albumForm) }}
                   {{ form_end(albumForm) }}
               </div>
            </div>
        </div>
    </div>
            
    <!-- Modal add a picture -->
    <div id="addPictureModal" class="modal" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                   <h5 class="modal-title">Ajout d'une P'tite Photo üèñÔ∏è</h5>
                   <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                       <span aria-hidden="true">&times;</span>
                   </button>
               </div>
               <div class="modal-body">
                   {{ form_start(pictureForm, {'method': 'post', 'action': path('add_picture')}) }}
                   {{ form_widget(pictureForm, {'attr': {'class': 'form-group'}}) }}
               </div>
                <div class="modal-footer">
                   <div class="form-group middle">
                       <input class=" btn btn-primary" type="submit" value="Ajouter" />
                   </div>
                   {{ form_rest(pictureForm) }}
                   {{ form_end(pictureForm) }}
               </div>
            </div>
        </div>
    </div>
            
    <!-- Modal add a song -->
    <div id="addSongModal" class="modal" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
               <div class="modal-header">
                   <h5 class="modal-title">Ajout d'une P'tite Musique üéß</h5>
                   <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                       <span aria-hidden="true">&times;</span>
                   </button>
               </div>
               <div class="modal-body">
                   {{ form_start(songForm, {'method': 'post', 'action': path('add_song')}) }}
                   {{ form_widget(songForm, {'attr': {'class': 'form-group'}}) }}
               </div>
                <div class="modal-footer">
                   <div class="form-group middle">
                       <input class=" btn btn-primary" type="submit" value="Ajouter" />
                   </div>
                   {{ form_rest(songForm) }}
                   {{ form_end(songForm) }}
               </div>
            </div>
        </div>
    </div>
      
       <script>
           $(document).ready(function(){
                //Autocomplete
                initializeAutocomplete('event_address');
                
                //Carrousel
                //$("#myCarousel").carousel();
                $('.carousel').carousel();
                 
                $('#click').click(function(e){
                  e.preventDefault();
                  alert('Click Click !');
                 });
                $('.fc-scroller').addClass("home_fc-scroller");
                
                //modal actions
                var modal = document.getElementById("addEventModal");
                var modal2 = document.getElementById("addAlbumModal");
                var modal3 = document.getElementById("addPictureModal");
                var modal4 = document.getElementById("addSongModal");
                
                $('.add-event').on('click', function(e) {
                    e.preventDefault();
                    $('#addEventModal').modal('show');
                });
                    
                $('.add-album').on('click', function(e) {
                    e.preventDefault();
                    $('#addAlbumModal').modal('show');
                });

                $('.add-picture').on('click', function(e) {
                    e.preventDefault();
                    $('#addPictureModal').modal('show');
                });

                $('.add-song').on('click', function(e) {
                    e.preventDefault();
                    $('#addSongModal').modal('show');
                });
           });
          
           //calendar js
           document.addEventListener('DOMContentLoaded', function() {
               var calendarEl = document.getElementById('calendar');

               var calendar = new FullCalendar.Calendar(calendarEl, {
                   plugins: ['list'],
                   locale: 'fr',
                   defaultView: 'listWeek',
                   events: [
                       {% for event in events %}
                       {
                           title: '{{ event.name }}',
                           start: '{{ event.startdate|date('Y-m-d') }}',
                           end: '{{ event.enddate|date('Y-m-d') }}',
                           url: '{{ path('event', { id: event.id})  }}'
                       },
                       {% endfor %}
                       {% for user in users %}
                       {
                           title: 'Anniversaire {{ user.prename }}',
                           start: '2020-{{ user.birthdate|date('m-d') }}',
                           allDay : true,
                           backgroundColor: 'red'

                       },
                       {
                           title: 'Anniversaire {{ user.prename }}',
                           start: '2021-{{ user.birthdate|date('m-d') }}',
                           allDay : true,
                           backgroundColor: 'red'
                       },
                       {% endfor %}
                   ]
               });
               calendar.render();
           });
           
            //Autocomplete 
            function initializeAutocomplete(id){
                var element = document.getElementById(id);  
                if (element) { 
                    var autocomplete = new google.maps.places.Autocomplete(element, { types: ['geocode'] });
                    google.maps.event.addListener(autocomplete, 'place_changed', onPlaceChanged);
                }
            }
           function onPlaceChanged() {
                var place = this.getPlace();
                console.log(place);  // Uncomment this line to view the full object returned by Google API.
                for (var i in place.address_components) {
                  var component = place.address_components[i];    
                  for (var j in component.types) {
                    var type_element = document.getElementById(component.types[j]);      
                    if (type_element) {
                      type_element.value = component.long_name;
                    }    
                  }  
                }
            }
       </script>
        <script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyA0wuGfkqLD67jR6NfcC8mm4EuUROGis_I"
    async defer></script>
  {% endblock %}
